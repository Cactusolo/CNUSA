View(good.table)
row.names(good.table) <- NULL
View(good.table)
combine_table <- rbind.data.frame(good.table, name_checked)
names(good.table)
colnames(good.table)
colnames(name_checked) <- colnames(good.table)
combine_table <- rbind.data.frame(good.table, name_checked)
View(combine_table)
head(combine_table)
setdiff(species, combine_table$Species)
library("tidyverse")
GA_table <- combine_table %>% mutate(combine_table, GA=ifelse(group %in% "Gymnosperms"), 0, 1) %>%
select(Species, GA)
combine_table <- as.data.frame(combine_table)
GA_table <- combine_table %>% mutate(combine_table, GA=ifelse(group %in% "Gymnosperms"), 0, 1) %>%
select(Species, GA)
GA_table <- mutate(combine_table, GA=ifelse(group %in% "Gymnosperms"), 0, 1) %>%
select(Species, GA)
GA_table <- mutate(combine_table, GA=ifelse(group %in% "Gymnosperms", 0, 1)) %>%
select(Species, GA)
View(GA_table)
head(GA_table)
write.csv(GA_table, "./result/CN_US_GA_matrix.csv", row.names = FALSE, quote=FALSE)
write.csv(combine_table, "./result/CN_US_taxonomy.csv", row.names = FALSE, quote=FALSE)
rm(list=ls())
# install.package("picante"）
library("picante")
library("phytools")
PD_caculator <- function(phy, name, data){
comm <- NULL
if(is.ultrametric(phy)!=TRUE){
phy <- force.ultrametric(phy, method="extend")
}
# if(sum(!complete.cases(phy$tip.label %in% colnames(data))) > 0){
#   for(i in grep("-", phy$tip.label)){
#     phy$tip.label[i] <- gsub("-", "", phy$tip.label[i])
#   }
#   colnames(data) <- gsub("-", "", data[1,])
#   data <- data[-1,]
# }
write.csv(data, paste0("./result/", name, "_checked_matrix.csv", sep=""))
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
# Standardized effect size of phylogenetic diversity (Faith's PD) in communities.
cat("calculate PD ...\n")
PD <- ses.pd(combined$comm, combined$phy, null.model = "taxa.labels", runs = 999, iterations = 1000)
# caculate Standardized effect size of mean pairwise distances (MPD) in communities
phy.dist <- cophenetic(phy)
cat("calculate MPD ...\n")
MPD <- ses.mpd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MPD["NRI"] <- -1*MPD$mpd.obs.z
# caculate Standardized effect size of  mean nearest taxon distances (MNTD) in communities
cat("calculate MNTD ...\n")
MNTD <- ses.mntd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MNTD["NTI"] <- -1*MNTD$mntd.obs.z
#write out table
write.csv(PD, paste0("./result/", name, "_PD.csv", sep=""))
write.csv(MPD, paste0("result/", name, "_MPD.csv", sep=""))
write.csv(MNTD, paste0("result/", name, "_MNTD.csv", sep=""))
}
dd <- read.csv("./result/CN_US_GA_matrix.csv", header = TRUE)
head(dd)
mutate(combine_table, Gymnosperms=ifelse(group %in% "Gymnosperms", 1, 0)) %>% head()
# write.csv(combine_table, "./result/CN_US_taxonomy.csv", row.names = FALSE, quote=FALSE)
combine_table <- read_csv("./result/CN_US_taxonomy.csv", col_names = TRUE)
head(combine_table)
tail(combine_table)
mutate(combine_table, Gymnosperms=ifelse(group %in% "Gymnosperms", 1, 0),
Angiosperms=ifelse(group %in% "Angiosperms", 1, 0)) %>% head()
GA_table <- mutate(combine_table, Gymnosperms=ifelse(group %in% "Gymnosperms", 1, 0),
Angiosperms=ifelse(group %in% "Angiosperms", 1, 0)) %>% select(Species, Gymnosperms, Angiosperms)
write.csv(GA_table, "./result/CN_US_GA_matrix.csv", row.names = FALSE, quote=FALSE)
dd <- read.csv("./result/CN_US_GA_matrix.csv", header = TRUE)
head(dd)
row.names(dd) <- c("Species", "Angiosperms", "Gymnosperm")
dd <- read.csv("./result/CN_US_GA_matrix.csv", header = TRUE)
dd <- t(dd)
head(dd)
colnames(dd)
View(dd)
row.names(dd)
colnames(dd) <- dd[1,]
dd[1,][1:6]
dd<- dd[-1,]
dim(dd)
#################PD_for_GA###################
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
View(dd)
name2 <- "CN2US_GA"
tree$tip.label <- gsub("-", ".", tree$tip.label)
PD_caculator(tree, name2, dd)
#################PD_for_GA###################
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
# tree$tip.label <- gsub("-", ".", tree$tip.label)
PD_caculator(tree, name2, dd)
dir()
dir("..")
####woody&herb
WH <- read_csv("../matrix_update/W_H/CN_US_species_WH_5608.csv", col_names = TRUE)
head(WH)
dim(WH)
length(tree$tip.label)
setdiff(WH$Species,tree$tip.label)
WH_table <- mutate(WH, Woody=ifelse(Life_Form %in% "W", 1, 0),
Herb=ifelse(Life_Form %in% "H", 1, 0)) %>% select(Species, Woody, Herb)
head(WH_table)
write.csv(WH_table, "./result/CN_USA_WH_matrix.csv", row.names = FALSE, quote=FALSE)
tt <- t(tt)
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
tt <- read.csv("./result/CN_USA_WH_matrix.csv", header = TRUE)
tt <- t(tt)
head(tt)[,1:6]
row.names(tt)
colnames(tt) <- tt[1,]
tt<- tt[-1,]
name <- "CN_US_LifeForm"
PD_caculator <- function(phy, name, data){
comm <- NULL
if(is.ultrametric(phy)!=TRUE){
phy <- force.ultrametric(phy, method="extend")
}
# if(sum(!complete.cases(phy$tip.label %in% colnames(data))) > 0){
#   for(i in grep("-", phy$tip.label)){
#     phy$tip.label[i] <- gsub("-", "", phy$tip.label[i])
#   }
#   colnames(data) <- gsub("-", "", data[1,])
#   data <- data[-1,]
# }
write.csv(data, paste0("./result/", name, "_checked_matrix.csv", sep=""))
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
# Standardized effect size of phylogenetic diversity (Faith's PD) in communities.
cat("calculate PD ...\n")
PD <- ses.pd(combined$comm, combined$phy, null.model = "taxa.labels", runs = 999, iterations = 1000)
# caculate Standardized effect size of mean pairwise distances (MPD) in communities
phy.dist <- cophenetic(phy)
cat("calculate MPD ...\n")
MPD <- ses.mpd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MPD["NRI"] <- -1*MPD$mpd.obs.z
# caculate Standardized effect size of  mean nearest taxon distances (MNTD) in communities
cat("calculate MNTD ...\n")
MNTD <- ses.mntd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MNTD["NTI"] <- -1*MNTD$mntd.obs.z
#write out table
write.csv(PD, paste0("./result/", name, "_PD.csv", sep=""))
write.csv(MPD, paste0("result/", name, "_MPD.csv", sep=""))
write.csv(MNTD, paste0("result/", name, "_MNTD.csv", sep=""))
}
PD_caculator(tree, name, tt)
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
library("ape")
library("taxonlookup")
library("tidyverse")
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
data <- read_csv("./data/CN_US.site.mtrx_present_absent.csv", col_names = TRUE)
head(data)
row.names(data)
data[1,]
data[,1]
row.names(data) <- data[,1]
data$Species
data2 <- group_by(Species) %>% filter(Species=="Changbai")
data2 <- data %>% group_by(Species) %>% filter(Species=="Changbai")
View(data2)
dim(data2)
data2[1,]
data2[data2[1,]==1,]
length(data2[data2[1,]==1,])
names(data2[1,]==1,])
names(data2[1,]==1)
names(data2[data2[1,]==1,])
length(names(data2[data2[1,]==1,]))
length(names(data2[data2==1,]))
length(names(data2[data2==1]))
data2[1,]
sum(data2[1,]==1)
data2[which(data2[1,]==1),]
names(data2[which(data2[1,]==1),])
Changbai.sp <- names(data2[which(data2[1,]==1),])
Changbai.sp[1]
data2[which(data2[1,]==1)]
Changbai.sp <- names(data2[which(data2[1,]==1)])
dir("data")
Changbai_list <- read.csv("./data/Changbai.txt", header=FALSE)
Changbai_list <- Changbai_list$V1
setdiff(Changbai_list, Changbai.sp)
sum(grep("Conyza_canadensis", Changbai_list))
length(grep("Conyza_canadensis", Changbai_list))
length(grep("Conyza_canadensis", Changbai.sp))
length(grep("Poa_pratensis_subsp._pratensis", Changbai_list))
length(grep("Poa_pratensis_subsp._pratensis", Changbai.sp))
length(grep("Poa_pratensis", Changbai.sp))
length(grep("Poa_pratensis", Changbai_list))
?comdist
# install.package("picante"）
library("picante")
?comdist
?comdistnt
rm(list=ls())
data(phylocom)
phylocom$sample
cophenetic(phylocom$phylo)
?cophenetic
comdist(phylocom$sample, cophenetic(phylocom$phylo), abundance.weighted=TRUE)
?comdistnt
?pcd
??pcd
rm(list=ls())
library("picante")
library("phytools")
library("cluster")
rm(list=ls())
# install.package("picante"）
library("picante")
library("phytools")
PD_caculator <- function(phy, name, data){
comm <- NULL
if(is.ultrametric(phy)!=TRUE){
phy <- force.ultrametric(phy, method="extend")
}
# if(sum(!complete.cases(phy$tip.label %in% colnames(data))) > 0){
#   for(i in grep("-", phy$tip.label)){
#     phy$tip.label[i] <- gsub("-", "", phy$tip.label[i])
#   }
#   colnames(data) <- gsub("-", "", data[1,])
#   data <- data[-1,]
# }
write.csv(data, paste0("./result/", name, "_checked_matrix.csv", sep=""))
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
# Standardized effect size of phylogenetic diversity (Faith's PD) in communities.
cat("calculate PD ...\n")
PD <- ses.pd(combined$comm, combined$phy, null.model = "taxa.labels", runs = 999, iterations = 1000)
# caculate Standardized effect size of mean pairwise distances (MPD) in communities
phy.dist <- cophenetic(phy)
cat("calculate MPD ...\n")
MPD <- ses.mpd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MPD["NRI"] <- -1*MPD$mpd.obs.z
# caculate Standardized effect size of  mean nearest taxon distances (MNTD) in communities
cat("calculate MNTD ...\n")
MNTD <- ses.mntd(combined$comm, phy.dist, null.model = "taxa.labels",
abundance.weighted = FALSE, runs = 999, iterations = 1000)
MNTD["NTI"] <- -1*MNTD$mntd.obs.z
#write out table
write.csv(PD, paste0("./result/", name, "_PD.csv", sep=""))
write.csv(MPD, paste0("result/", name, "_MPD.csv", sep=""))
write.csv(MNTD, paste0("result/", name, "_MNTD.csv", sep=""))
}
CN.tree <- read.tree("./data/Whole_CN_190510_ed.tre")
uu <- read.csv("./data/CN.cnmtrx_present_absent.csv", header=TRUE)
head(uu)
row.names(uu)
row.names(uu) <- as.character(uu[,1])
uu <- uu[,-1]
row.names(uu)
grep("-",CN.tree$tip.label)
grep("-",colnames(uu))
grep(".",colnames(uu))
grep("-",CN.tree$tip.label)
CN.tree$tip.label[25]
grep("Larix_gmelinii", colnames(uu))
colnames(uu)[1829, 1830, 1831]
class(colnames(uu))
colnames(uu)[1829]
colnames(uu)[c(1829, 1830, 1831)]
CN.tree$tip.label <- gsub("-", ".", CN.tree$tip.label)
data <- uu
name <- "CN"
PD_caculator(US.tree, name, data)
PD_caculator(CN.tree, name, data)
tree <- CN.tree
comm <- NULL
if(is.ultrametric(tree)!=TRUE){
tree <- force.ultrametric(tree, method="extend")
}
phy <- tree
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
phy.dist <- cophenetic(phy)
cat("Calculates inter-community mean pairwise distance --- comdist ...\n")
comdist.result <- comdist(comm, phy.dist)
comdist.clusters <- hclust(comdist.result)
cat("Calculates inter-community mean nearest taxon distance --- comdistnt  ...\n")
comdistnt.result <- comdistnt(comm, phy.dist)
comdistnt.clusters <- hclust(comdistnt.result)
cat("Calculates Phylogenetic Community Dissimilarity --- pcd  ...\n")
PCD <- pcd(comm, tree, PSVmncd=NULL, PSVpool=NULL, reps=10^4)
rm(list=ls())
library("picante")
library("phytools")
library("cluster")
PD_caculator <- function(data, tree, name){
comm <- NULL
if(is.ultrametric(tree)!=TRUE){
tree <- force.ultrametric(tree, method="extend")
}
phy <- tree
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
phy.dist <- cophenetic(phy)
# comdist
#Calculates mean pairwise distance (MPD) separating taxa in two communities
#a measure of phylogenetic beta diversity
cat("Calculates inter-community mean pairwise distance --- comdist ...\n")
comdist.result <- comdist(comm, phy.dist)
comdist.clusters <- hclust(comdist.result)
cat("Calculates inter-community mean nearest taxon distance --- comdistnt  ...\n")
comdistnt.result <- comdistnt(comm, phy.dist)
comdistnt.clusters <- hclust(comdistnt.result)
cat("Calculates Phylogenetic Community Dissimilarity --- pcd  ...\n")
pcd.result <- pcd(comm, tree)
cat("Calculates Unweighted UniFrac distance between communities --- UniF ...\n")
Unif <- unifrac(phylocom$sample, phylocom$phylo)
pdf(paste0("result/Beta_diversity/", name, "beta_diversity_plot.pdf"), height = 6, width = 4)
# par(mfrow = c(1, 2))
plot(comdist.clusters, main=paste0(name, " sites"), sub="MPD_beta", xlab="")
# axis(2, at = c(0, axTicks(2)), cex.axis = 0.8, mgp = c(3, 0.7, 0.5))
# plot(as.dendrogram(comdistnt.clusters), horiz=TRUE, main="CN-US 11 sites mean nearest taxon distance", sub="Beta Diversity", xlab="")
plot(comdistnt.clusters, main=paste0(name," sites"), sub="MNTD_beta", xlab="")
dev.off()
#write out table
write.table(as.matrix(comdist.result), paste0("./result/Beta_diversity/", name, "_comdist.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(comdistnt.result), paste0("result/Beta_diversity/", name, "_comdistnt.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCD), paste0("result/Beta_diversity/", name, "_PCD_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDc), paste0("result/Beta_diversity/", name, "_PCDc_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDp), paste0("result/Beta_diversity/", name, "_PCDp_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVmncd), paste0("result/Beta_diversity/", name, "_PSVmncd_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVpool), paste0("result/Beta_diversity/", name, "_PSVpool_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(Unif), paste0("result/Beta_diversity/", name, "_UniFrac.csv", sep=""), quote = FALSE, sep = ",")
}
# dir.create("result/Beta_diversity")
tree <- read.tree("./data/CN_US_speciesname_BR_addMay52019.tre")
tree$tip.label <- gsub("-", ".", tree$tip.label)
data <- read.csv("./result/CNUS11_NW_checked_matrix.csv", header = TRUE)
row.names(data) <- data[,1]
data <- data[,-1]
name <- "CNUS_11"
PD_caculator(data, tree, name)
#US_whole
tree <- read.tree("./data/Whole_speciesname_BR_addMay52019.tre")
tree$tip.label <- gsub("-", ".", tree$tip.label)
data <- read.csv("./result/US_checked_matrix.csv", header = TRUE)
row.names(data) <- data[,1]
data <- data[,-1]
name <- "US_6"
PD_caculator(data, tree, name)
#CN_whole
CN.tree <- read.tree("./data/Whole_CN_190510_ed.tre")
CN.tree$tip.label <- gsub("-", ".", CN.tree$tip.label)
uu <- read.csv("./data/CN.cnmtrx_present_absent.csv", header=TRUE)
row.names(uu) <- as.character(uu[,1])
uu <- uu[,-1]
data <- uu
name <- "CN_5"
tree <- CN.tree
PD_caculator(data,CN.tree, name)
devtools::install_github("daijiang/phyr")
dev.off()
rm(list=ls())
library("picante")
library("phytools")
library("cluster")
devtools::install_github("daijiang/phyr")
install.packages("https://raw.githubusercontent.com/daijiang/phyr/master/phyr_0.1.5.zip", repos = NULL)
rm(list=ls())
library("picante")
library("phytools")
library("cluster")
library("phyr")
PD_caculator <- function(data, tree, name){
comm <- NULL
if(is.ultrametric(tree)!=TRUE){
tree <- force.ultrametric(tree, method="extend")
}
phy <- tree
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
phy.dist <- cophenetic(phy)
# comdist
#Calculates mean pairwise distance (MPD) separating taxa in two communities
#a measure of phylogenetic beta diversity
cat("Calculates inter-community mean pairwise distance --- comdist ...\n")
comdist.result <- comdist(comm, phy.dist)
comdist.clusters <- hclust(comdist.result)
cat("Calculates inter-community mean nearest taxon distance --- comdistnt  ...\n")
comdistnt.result <- comdistnt(comm, phy.dist)
comdistnt.clusters <- hclust(comdistnt.result)
cat("Calculates Phylogenetic Community Dissimilarity --- pcd  ...\n")
pcd.result <- phyr::pcd(comm, tree)
cat("Calculates Unweighted UniFrac distance between communities --- UniF ...\n")
Unif <- unifrac(phylocom$sample, phylocom$phylo)
pdf(paste0("result/Beta_diversity/", name, "beta_diversity_plot.pdf"), height = 6, width = 4)
# par(mfrow = c(1, 2))
plot(comdist.clusters, main=paste0(name, " sites"), sub="MPD_beta", xlab="")
# axis(2, at = c(0, axTicks(2)), cex.axis = 0.8, mgp = c(3, 0.7, 0.5))
# plot(as.dendrogram(comdistnt.clusters), horiz=TRUE, main="CN-US 11 sites mean nearest taxon distance", sub="Beta Diversity", xlab="")
plot(comdistnt.clusters, main=paste0(name," sites"), sub="MNTD_beta", xlab="")
dev.off()
#write out table
write.table(as.matrix(comdist.result), paste0("./result/Beta_diversity/", name, "_comdist.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(comdistnt.result), paste0("result/Beta_diversity/", name, "_comdistnt.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCD), paste0("result/Beta_diversity/", name, "_PCD_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDc), paste0("result/Beta_diversity/", name, "_PCDc_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDp), paste0("result/Beta_diversity/", name, "_PCDp_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVmncd), paste0("result/Beta_diversity/", name, "_PSVmncd_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVpool), paste0("result/Beta_diversity/", name, "_PSVpool_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(Unif), paste0("result/Beta_diversity/", name, "_UniFrac.csv", sep=""), quote = FALSE, sep = ",")
}
CN.tree <- read.tree("./data/Whole_CN_190510_ed.tre")
CN.tree$tip.label <- gsub("-", ".", CN.tree$tip.label)
uu <- read.csv("./data/CN.cnmtrx_present_absent.csv", header=TRUE)
row.names(uu) <- as.character(uu[,1])
uu <- uu[,-1]
data <- uu
name <- "CN_5"
tree <- CN.tree
PD_caculator(data,CN.tree, name)
rm(list=ls())
library("picante")
library("phytools")
library("cluster")
library("phyr")
# install.packages("https://raw.githubusercontent.com/daijiang/phyr/master/phyr_0.1.5.zip", repos = NULL)
PD_caculator <- function(data, tree, name){
comm <- NULL
if(is.ultrametric(tree)!=TRUE){
tree <- force.ultrametric(tree, method="extend")
}
phy <- tree
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
phy.dist <- cophenetic(phy)
# comdist
#Calculates mean pairwise distance (MPD) separating taxa in two communities
#a measure of phylogenetic beta diversity
cat("Calculates inter-community mean pairwise distance --- comdist ...\n")
comdist.result <- comdist(comm, phy.dist)
comdist.clusters <- hclust(comdist.result)
cat("Calculates inter-community mean nearest taxon distance --- comdistnt  ...\n")
comdistnt.result <- comdistnt(comm, phy.dist)
comdistnt.clusters <- hclust(comdistnt.result)
cat("Calculates Phylogenetic Community Dissimilarity --- pcd  ...\n")
pcd.result <- phyr::pcd(comm, tree)
cat("Calculates Unweighted UniFrac distance between communities --- UniF ...\n")
Unif <- unifrac(comm, tree)
pdf(paste0("result/Beta_diversity/", name, "beta_diversity_plot.pdf"), height = 6, width = 4)
# par(mfrow = c(1, 2))
plot(comdist.clusters, main=paste0(name, " sites"), sub="MPD_beta", xlab="")
# axis(2, at = c(0, axTicks(2)), cex.axis = 0.8, mgp = c(3, 0.7, 0.5))
# plot(as.dendrogram(comdistnt.clusters), horiz=TRUE, main="CN-US 11 sites mean nearest taxon distance", sub="Beta Diversity", xlab="")
plot(comdistnt.clusters, main=paste0(name," sites"), sub="MNTD_beta", xlab="")
dev.off()
#write out table
write.table(as.matrix(comdist.result), paste0("./result/Beta_diversity/", name, "_comdist.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(comdistnt.result), paste0("result/Beta_diversity/", name, "_comdistnt.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCD), paste0("result/Beta_diversity/", name, "_PCD_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDc), paste0("result/Beta_diversity/", name, "_PCDc_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDp), paste0("result/Beta_diversity/", name, "_PCDp_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVmncd), paste0("result/Beta_diversity/", name, "_PSVmncd_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PSVpool), paste0("result/Beta_diversity/", name, "_PSVpool_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(Unif), paste0("result/Beta_diversity/", name, "_UniFrac.csv", sep=""), quote = FALSE, sep = ",")
}
#CN_whole
CN.tree <- read.tree("./data/Whole_CN_190510_ed.tre")
CN.tree$tip.label <- gsub("-", ".", CN.tree$tip.label)
uu <- read.csv("./data/CN.cnmtrx_present_absent.csv", header=TRUE)
row.names(uu) <- as.character(uu[,1])
uu <- uu[,-1]
data <- uu
name <- "CN_5"
tree <- CN.tree
PD_caculator(data,CN.tree, name)
phy <- tree
comm <- data
combined <- match.phylo.comm(phy, comm)
phy<- combined$phy
comm <- combined$comm
Unif <- unifrac(comm, tree)
Unif
pcd.result <- phyr::pcd(comm, tree)
pcd.result$dsor_pairwise
?phyr::pcd
?pcd_pred
pcd.result$D_pairwise
write.table(as.matrix(comdist.result), paste0("./result/Beta_diversity/", name, "_comdist.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(comdistnt.result), paste0("result/Beta_diversity/", name, "_comdistnt.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCD), paste0("result/Beta_diversity/", name, "_PCD_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDc), paste0("result/Beta_diversity/", name, "_PCDc_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(pcd.result$PCDp), paste0("result/Beta_diversity/", name, "_PCDp_matrix.csv", sep=""), quote = FALSE, sep = ",")
# write.table(as.matrix(pcd.result$PSVmncd), paste0("result/Beta_diversity/", name, "_PSVmncd_matrix.csv", sep=""), quote = FALSE, sep = ",")
# write.table(pcd.result$PSVpool, paste0("result/Beta_diversity/", name, "_PSVpool_matrix.csv", sep=""), quote = FALSE, sep = ",")
write.table(as.matrix(Unif), paste0("result/Beta_diversity/", name, "_UniFrac.csv", sep=""), quote = FALSE, sep = ",")
